<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FGSSmap ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒãƒ¼ã‚¯å‹Ÿé›†</title>
    <meta name="description" content="å±±å£å¤§å­¦å›½éš›ç·åˆç§‘å­¦éƒ¨10å‘¨å¹´è¨˜å¿µ - ã‚ãªãŸã®æ€ã„å‡ºã®å ´æ‰€ã‚’FGSSmapã«è¿½åŠ ã—ã¾ã›ã‚“ã‹ï¼Ÿ">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans JP', 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            padding: 3rem 2rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 1rem;
            font-weight: 700;
        }
        
        .header .subtitle {
            font-size: 1.1rem;
            color: #7f8c8d;
            margin-bottom: 2rem;
        }
        
        .header .university-badge {
            display: inline-block;
            background: linear-gradient(135deg, #3498db, #9b59b6);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        /* ã‚¹ãƒ†ãƒƒãƒ—é€²æ—è¡¨ç¤º */
        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .progress-steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .progress-step {
            flex: 1;
            text-align: center;
            position: relative;
            padding: 0.5rem;
        }
        
        .progress-step::after {
            content: '';
            position: absolute;
            top: 50%;
            right: 0;
            width: 100%;
            height: 2px;
            background: #e0e0e0;
            z-index: 1;
        }
        
        .progress-step:last-child::after {
            display: none;
        }
        
        .progress-step.active::after {
            background: linear-gradient(to right, #667eea, #764ba2);
        }
        
        .progress-number {
            display: inline-block;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #e0e0e0;
            color: #999;
            line-height: 40px;
            font-weight: 600;
            margin-bottom: 0.5rem;
            z-index: 2;
            position: relative;
        }
        
        .progress-step.active .progress-number {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .progress-step.completed .progress-number {
            background: #27ae60;
            color: white;
        }
        
        .progress-label {
            font-size: 0.8rem;
            color: #666;
        }
        
        .progress-step.active .progress-label {
            color: #333;
            font-weight: 600;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ãƒŠ */
        .form-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 3rem 2rem;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
        }
        
        .step {
            display: none;
        }
        
        .step.active {
            display: block;
        }
        
        .step-title {
            font-size: 1.8rem;
            color: #2c3e50;
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: 600;
        }
        
        .step-description {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 2rem;
            font-size: 1rem;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ è¦ç´  */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #2c3e50;
        }
        
        .form-label.required::after {
            content: ' *';
            color: #e74c3c;
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .form-control.error {
            border-color: #e74c3c;
            background-color: #fdf2f2;
        }
        
        .form-control.success {
            border-color: #27ae60;
            background-color: #f0f9f0;
        }
        
        textarea.form-control {
            resize: vertical;
            min-height: 100px;
        }

        /* é¸æŠè‚¢ãƒœã‚¿ãƒ³ */
        .choice-buttons {
            display: grid;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .choice-button {
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-family: inherit;
            font-size: 1rem;
        }
        
        .choice-button:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .choice-button.active {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .choice-button i {
            margin-right: 0.5rem;
            font-size: 1.2rem;
        }

        /* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ */
        .checkbox-container {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 1rem;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            background: #f8f9fa;
        }
        
        .checkbox-container input[type="checkbox"] {
            margin-top: 0.2rem;
        }
        
        .checkbox-container.error {
            border-color: #e74c3c;
            background-color: #fdf2f2;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            gap: 1rem;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            font-family: inherit;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #545b62;
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ */
        .error-message {
            background: #fdf2f2;
            color: #e74c3c;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid #e74c3c;
        }
        
        .success-message {
            background: #f0f9f0;
            color: #27ae60;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            border-left: 4px solid #27ae60;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .header {
                padding: 2rem 1rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .form-container {
                padding: 2rem 1rem;
            }
            
            .progress-steps {
                flex-wrap: wrap;
            }
            
            .progress-step {
                min-width: 100px;
                margin-bottom: 1rem;
            }
            
            .navigation-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .step-title {
                font-size: 1.4rem;
            }
            
            .choice-buttons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="header">
            <h1><i class="fas fa-map-marker-alt"></i> FGSSmap ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒãƒ¼ã‚¯å‹Ÿé›†</h1>
            <p class="subtitle">ã‚ãªãŸã®æ€ã„å‡ºã®å ´æ‰€ã‚’FGSSmapã«è¿½åŠ ã—ã¾ã›ã‚“ã‹ï¼Ÿ</p>
            <div class="university-badge">å±±å£å¤§å­¦å›½éš›ç·åˆç§‘å­¦éƒ¨ 10å‘¨å¹´è¨˜å¿µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</div>
        </div>

        <!-- ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤º -->
        <div class="progress-container">
            <div class="progress-steps" id="progressSteps">
                <div class="progress-step active" data-step="1">
                    <div class="progress-number">1</div>
                    <div class="progress-label">åŒæ„ç¢ºèª</div>
                </div>
                <div class="progress-step" data-step="2">
                    <div class="progress-number">2</div>
                    <div class="progress-label">åŸºæœ¬æƒ…å ±</div>
                </div>
                <div class="progress-step" data-step="3">
                    <div class="progress-number">3</div>
                    <div class="progress-label">åœ°å›³ç¯„å›²</div>
                </div>
                <div class="progress-step" data-step="4">
                    <div class="progress-number">4</div>
                    <div class="progress-label">åœ°åŸŸé¸æŠ</div>
                </div>
                <div class="progress-step" data-step="5">
                    <div class="progress-number">5</div>
                    <div class="progress-label">å ´æ‰€è©³ç´°</div>
                </div>
                <div class="progress-step" data-step="6">
                    <div class="progress-number">6</div>
                    <div class="progress-label">é€ä¿¡</div>
                </div>
            </div>
        </div>

        <!-- ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ãƒŠ -->
        <div class="form-container">
            <form id="multiStepForm">
                <!-- ã‚¹ãƒ†ãƒƒãƒ—1: åŒæ„ç¢ºèª -->
                <div class="step active" data-step="1">
                    <h2 class="step-title">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼åŒæ„ã®ç¢ºèª</h2>
                    <p class="step-description">å‚åŠ ã«ã‚ãŸã‚Šã€ä»¥ä¸‹ã®å†…å®¹ã«ã”åŒæ„ãã ã•ã„ã€‚</p>
                    
                    <div class="form-group">
                        <div class="checkbox-container" id="agreementContainer">
                            <input type="checkbox" id="privacyAgreement" name="privacyAgreement">
                            <label for="privacyAgreement">
                                <strong>ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼ã«åŒæ„ã—ã¾ã™ã€‚</strong><br>
                                æä¾›ã„ãŸã ã„ãŸæƒ…å ±ã¯ã€FGSSmapä½œæˆã®ç›®çš„ã®ã¿ã«ä½¿ç”¨ã—ã€é©åˆ‡ã«ç®¡ç†ã„ãŸã—ã¾ã™ã€‚å€‹äººã‚’ç‰¹å®šã§ãã‚‹å½¢ã§ã®å…¬é–‹ã¯è¡Œã„ã¾ã›ã‚“ã€‚
                            </label>
                        </div>
                    </div>
                </div>

                <!-- ã‚¹ãƒ†ãƒƒãƒ—2: åŸºæœ¬æƒ…å ± -->
                <div class="step" data-step="2">
                    <h2 class="step-title">åŸºæœ¬æƒ…å ±ã®å…¥åŠ›</h2>
                    <p class="step-description">ã‚ãªãŸã®åŸºæœ¬æƒ…å ±ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚</p>
                    
                    <div class="form-group">
                        <label for="name" class="form-label required">ãŠåå‰ï¼ˆãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ å¯ï¼‰</label>
                        <input type="text" id="name" name="name" class="form-control" 
                               placeholder="ä¾‹: å±±å£ å¤ªéƒ ã¾ãŸã¯ ã‚„ã¾ãã¡ã•ã‚“">
                    </div>
                    
                    <div class="form-group">
                        <label for="admissionYear" class="form-label required">å…¥å­¦å¹´åº¦</label>
                        <select id="admissionYear" name="admissionYear" class="form-control">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="2015">2015å¹´åº¦</option>
                            <option value="2016">2016å¹´åº¦</option>
                            <option value="2017">2017å¹´åº¦</option>
                            <option value="2018">2018å¹´åº¦</option>
                            <option value="2019">2019å¹´åº¦</option>
                            <option value="2020">2020å¹´åº¦</option>
                            <option value="2021">2021å¹´åº¦</option>
                            <option value="2022">2022å¹´åº¦</option>
                            <option value="2023">2023å¹´åº¦</option>
                            <option value="2024">2024å¹´åº¦</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="department" class="form-label required">æ‰€å±å­¦éƒ¨ãƒ»ã‚³ãƒ¼ã‚¹</label>
                        <select id="department" name="department" class="form-control">
                            <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                            <option value="å›½éš›ç·åˆç§‘å­¦éƒ¨">å›½éš›ç·åˆç§‘å­¦éƒ¨</option>
                            <option value="äººæ–‡å­¦éƒ¨">äººæ–‡å­¦éƒ¨</option>
                            <option value="æ•™è‚²å­¦éƒ¨">æ•™è‚²å­¦éƒ¨</option>
                            <option value="çµŒæ¸ˆå­¦éƒ¨">çµŒæ¸ˆå­¦éƒ¨</option>
                            <option value="ç†å­¦éƒ¨">ç†å­¦éƒ¨</option>
                            <option value="å·¥å­¦éƒ¨">å·¥å­¦éƒ¨</option>
                            <option value="è¾²å­¦éƒ¨">è¾²å­¦éƒ¨</option>
                            <option value="åŒ»å­¦éƒ¨">åŒ»å­¦éƒ¨</option>
                            <option value="ãã®ä»–">ãã®ä»–</option>
                        </select>
                    </div>
                </div>

                <!-- ã‚¹ãƒ†ãƒƒãƒ—3: åœ°å›³ç¯„å›²é¸æŠ -->
                <div class="step" data-step="3">
                    <h2 class="step-title">åœ°å›³ã®ç¯„å›²ã‚’é¸æŠ</h2>
                    <p class="step-description">æ€ã„å‡ºã®å ´æ‰€ãŒã‚ã‚‹åœ°å›³ã®ç¯„å›²ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    
                    <div class="choice-buttons">
                        <button type="button" class="choice-button" data-value="campus">
                            <i class="fas fa-university"></i>
                            ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾º
                        </button>
                        <button type="button" class="choice-button" data-value="japan">
                            <i class="fas fa-flag"></i>
                            æ—¥æœ¬å…¨å›½
                        </button>
                        <button type="button" class="choice-button" data-value="world">
                            <i class="fas fa-globe"></i>
                            å…¨ä¸–ç•Œ
                        </button>
                    </div>
                    
                    <input type="hidden" id="mapType" name="mapType">
                </div>

                <!-- ã‚¹ãƒ†ãƒƒãƒ—4: åœ°åŸŸé¸æŠ -->
                <div class="step" data-step="4">
                    <h2 class="step-title">åœ°åŸŸã‚’é¸æŠ</h2>
                    <p class="step-description">æ€ã„å‡ºã®å ´æ‰€ãŒã‚ã‚‹åœ°åŸŸã‚’é¸ã‚“ã§ãã ã•ã„ã€‚</p>
                    
                    <!-- æ—¥æœ¬å›½å†…ç”¨ -->
                    <div id="japanAreaSelection" style="display: none;">
                        <div class="form-group">
                            <label for="prefecture" class="form-label required">éƒ½é“åºœçœŒ</label>
                            <select id="prefecture" name="prefecture" class="form-control">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="åŒ—æµ·é“">åŒ—æµ·é“</option>
                                <option value="é’æ£®çœŒ">é’æ£®çœŒ</option>
                                <option value="å²©æ‰‹çœŒ">å²©æ‰‹çœŒ</option>
                                <option value="å®®åŸçœŒ">å®®åŸçœŒ</option>
                                <option value="ç§‹ç”°çœŒ">ç§‹ç”°çœŒ</option>
                                <option value="å±±å½¢çœŒ">å±±å½¢çœŒ</option>
                                <option value="ç¦å³¶çœŒ">ç¦å³¶çœŒ</option>
                                <option value="èŒ¨åŸçœŒ">èŒ¨åŸçœŒ</option>
                                <option value="æ ƒæœ¨çœŒ">æ ƒæœ¨çœŒ</option>
                                <option value="ç¾¤é¦¬çœŒ">ç¾¤é¦¬çœŒ</option>
                                <option value="åŸ¼ç‰çœŒ">åŸ¼ç‰çœŒ</option>
                                <option value="åƒè‘‰çœŒ">åƒè‘‰çœŒ</option>
                                <option value="æ±äº¬éƒ½">æ±äº¬éƒ½</option>
                                <option value="ç¥å¥ˆå·çœŒ">ç¥å¥ˆå·çœŒ</option>
                                <option value="æ–°æ½ŸçœŒ">æ–°æ½ŸçœŒ</option>
                                <option value="å¯Œå±±çœŒ">å¯Œå±±çœŒ</option>
                                <option value="çŸ³å·çœŒ">çŸ³å·çœŒ</option>
                                <option value="ç¦äº•çœŒ">ç¦äº•çœŒ</option>
                                <option value="å±±æ¢¨çœŒ">å±±æ¢¨çœŒ</option>
                                <option value="é•·é‡çœŒ">é•·é‡çœŒ</option>
                                <option value="å²é˜œçœŒ">å²é˜œçœŒ</option>
                                <option value="é™å²¡çœŒ">é™å²¡çœŒ</option>
                                <option value="æ„›çŸ¥çœŒ">æ„›çŸ¥çœŒ</option>
                                <option value="ä¸‰é‡çœŒ">ä¸‰é‡çœŒ</option>
                                <option value="æ»‹è³€çœŒ">æ»‹è³€çœŒ</option>
                                <option value="äº¬éƒ½åºœ">äº¬éƒ½åºœ</option>
                                <option value="å¤§é˜ªåºœ">å¤§é˜ªåºœ</option>
                                <option value="å…µåº«çœŒ">å…µåº«çœŒ</option>
                                <option value="å¥ˆè‰¯çœŒ">å¥ˆè‰¯çœŒ</option>
                                <option value="å’Œæ­Œå±±çœŒ">å’Œæ­Œå±±çœŒ</option>
                                <option value="é³¥å–çœŒ">é³¥å–çœŒ</option>
                                <option value="å³¶æ ¹çœŒ">å³¶æ ¹çœŒ</option>
                                <option value="å²¡å±±çœŒ">å²¡å±±çœŒ</option>
                                <option value="åºƒå³¶çœŒ">åºƒå³¶çœŒ</option>
                                <option value="å±±å£çœŒ">å±±å£çœŒ</option>
                                <option value="å¾³å³¶çœŒ">å¾³å³¶çœŒ</option>
                                <option value="é¦™å·çœŒ">é¦™å·çœŒ</option>
                                <option value="æ„›åª›çœŒ">æ„›åª›çœŒ</option>
                                <option value="é«˜çŸ¥çœŒ">é«˜çŸ¥çœŒ</option>
                                <option value="ç¦å²¡çœŒ">ç¦å²¡çœŒ</option>
                                <option value="ä½è³€çœŒ">ä½è³€çœŒ</option>
                                <option value="é•·å´çœŒ">é•·å´çœŒ</option>
                                <option value="ç†Šæœ¬çœŒ">ç†Šæœ¬çœŒ</option>
                                <option value="å¤§åˆ†çœŒ">å¤§åˆ†çœŒ</option>
                                <option value="å®®å´çœŒ">å®®å´çœŒ</option>
                                <option value="é¹¿å…å³¶çœŒ">é¹¿å…å³¶çœŒ</option>
                                <option value="æ²–ç¸„çœŒ">æ²–ç¸„çœŒ</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- ä¸–ç•Œç”¨ -->
                    <div id="worldAreaSelection" style="display: none;">
                        <div class="form-group">
                            <label for="worldArea" class="form-label required">ä¸–ç•Œã®åœ°åŸŸ</label>
                            <select id="worldArea" name="worldArea" class="form-control">
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="æ±ã‚¢ã‚¸ã‚¢">æ±ã‚¢ã‚¸ã‚¢ï¼ˆä¸­å›½ã€éŸ“å›½ã€å°æ¹¾ãªã©ï¼‰</option>
                                <option value="æ±å—ã‚¢ã‚¸ã‚¢">æ±å—ã‚¢ã‚¸ã‚¢ï¼ˆã‚¿ã‚¤ã€ãƒ™ãƒˆãƒŠãƒ ã€ãƒ•ã‚£ãƒªãƒ”ãƒ³ãªã©ï¼‰</option>
                                <option value="å—ã‚¢ã‚¸ã‚¢">å—ã‚¢ã‚¸ã‚¢ï¼ˆã‚¤ãƒ³ãƒ‰ã€ãƒãƒ³ã‚°ãƒ©ãƒ‡ã‚·ãƒ¥ãªã©ï¼‰</option>
                                <option value="è¥¿ã‚¢ã‚¸ã‚¢ãƒ»ä¸­æ±">è¥¿ã‚¢ã‚¸ã‚¢ãƒ»ä¸­æ±ï¼ˆãƒˆãƒ«ã‚³ã€ã‚¤ãƒ©ãƒ³ãªã©ï¼‰</option>
                                <option value="ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘">ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘</option>
                                <option value="åŒ—ã‚¢ãƒ¡ãƒªã‚«">åŒ—ã‚¢ãƒ¡ãƒªã‚«ï¼ˆã‚¢ãƒ¡ãƒªã‚«ã€ã‚«ãƒŠãƒ€ï¼‰</option>
                                <option value="ä¸­å—ç±³">ä¸­å—ç±³</option>
                                <option value="ã‚¢ãƒ•ãƒªã‚«">ã‚¢ãƒ•ãƒªã‚«</option>
                                <option value="ã‚ªã‚»ã‚¢ãƒ‹ã‚¢">ã‚ªã‚»ã‚¢ãƒ‹ã‚¢ï¼ˆã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢ã€ãƒ‹ãƒ¥ãƒ¼ã‚¸ãƒ¼ãƒ©ãƒ³ãƒ‰ãªã©ï¼‰</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- ã‚¹ãƒ†ãƒƒãƒ—5: å ´æ‰€è©³ç´° -->
                <div class="step" data-step="5">
                    <h2 class="step-title">æ€ã„å‡ºã®å ´æ‰€ã«ã¤ã„ã¦</h2>
                    <p class="step-description">æ€ã„å‡ºã®å ´æ‰€ã®è©³ç´°ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚</p>
                    
                    <div class="form-group">
                        <label for="placeName" class="form-label required">å ´æ‰€ã®åå‰</label>
                        <input type="text" id="placeName" name="placeName" class="form-control" 
                               placeholder="ä¾‹: å±±å£å¤§å­¦å›³æ›¸é¤¨ã€æ¸‹è°·ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹">
                    </div>
                    
                    <div class="form-group">
                        <label for="memoryContent" class="form-label required">æ€ã„å‡ºã®å†…å®¹</label>
                        <textarea id="memoryContent" name="memoryContent" class="form-control" 
                                  placeholder="ã“ã®å ´æ‰€ã§ã®æ€ã„å‡ºã‚„ã‚¨ãƒ”ã‚½ãƒ¼ãƒ‰ã‚’æ•™ãˆã¦ãã ã•ã„"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="locationInfo" class="form-label">ä½æ‰€ãƒ»åº§æ¨™æƒ…å ±ï¼ˆä»»æ„ï¼‰</label>
                        <textarea id="locationInfo" name="locationInfo" class="form-control" 
                                  placeholder="è©³ã—ã„ä½æ‰€ã‚„GPSåº§æ¨™ãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„"></textarea>
                    </div>
                    
                    <!-- å½¹ç«‹ã¤ãƒ•ãƒ¬ãƒ¼ã‚ºï¼ˆæµ·å¤–é¸æŠæ™‚ã®ã¿è¡¨ç¤ºï¼‰ -->
                    <div id="usefulPhraseGroup" class="form-group" style="display: none;">
                        <label for="usefulPhrase" class="form-label">ç¾åœ°ã§å½¹ç«‹ã¤ãƒ•ãƒ¬ãƒ¼ã‚ºï¼ˆä»»æ„ï¼‰</label>
                        <input type="text" id="usefulPhrase" name="usefulPhrase" class="form-control" 
                               placeholder="ä¾‹: Where is the bathroom? / Â¿DÃ³nde estÃ¡ el baÃ±o?">
                    </div>
                </div>

                <!-- ã‚¹ãƒ†ãƒƒãƒ—6: é€ä¿¡ç¢ºèª -->
                <div class="step" data-step="6">
                    <h2 class="step-title">é€ä¿¡ç¢ºèª</h2>
                    <p class="step-description">å…¥åŠ›å†…å®¹ã‚’ç¢ºèªã—ã¦é€ä¿¡ã—ã¦ãã ã•ã„ã€‚</p>
                    
                    <div id="confirmationContent">
                        <!-- ç¢ºèªå†…å®¹ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                    
                    <div id="submitMessage" style="display: none;"></div>
                </div>

                <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ -->
                <div class="navigation-buttons">
                    <button type="button" id="prevBtn" class="btn btn-secondary" style="display: none;">
                        <i class="fas fa-chevron-left"></i> å‰ã¸
                    </button>
                    
                    <div style="flex: 1;"></div>
                    
                    <button type="button" id="nextBtn" class="btn btn-primary" disabled>
                        æ¬¡ã¸ <i class="fas fa-chevron-right"></i>
                    </button>
                    
                    <button type="submit" id="submitBtn" class="btn btn-primary" style="display: none;">
                        <i class="fas fa-paper-plane"></i> é€ä¿¡
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="js/google-forms.js"></script>
    <script>
        // 6ã‚¹ãƒ†ãƒƒãƒ—ãƒ•ã‚©ãƒ¼ãƒ ç®¡ç†ã‚¯ãƒ©ã‚¹
        class MultiStepFormManager {
            constructor() {
                this.currentStep = 1;
                this.totalSteps = 6;
                this.formData = {};
                
                this.initializeElements();
                this.bindEvents();
                this.updateUI();
                
                console.log('ğŸš€ MultiStepFormManageråˆæœŸåŒ–å®Œäº†');
            }
            
            initializeElements() {
                this.form = document.getElementById('multiStepForm');
                this.steps = document.querySelectorAll('.step');
                this.progressSteps = document.querySelectorAll('.progress-step');
                this.prevBtn = document.getElementById('prevBtn');
                this.nextBtn = document.getElementById('nextBtn');
                this.submitBtn = document.getElementById('submitBtn');
                
                // åœ°å›³ã‚¿ã‚¤ãƒ—é¸æŠãƒœã‚¿ãƒ³
                this.mapTypeButtons = document.querySelectorAll('.step[data-step="3"] .choice-button');
                
                console.log('ğŸ“‹ ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ åˆæœŸåŒ–å®Œäº†');
            }
            
            bindEvents() {
                // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³
                this.prevBtn.addEventListener('click', () => this.previousStep());
                this.nextBtn.addEventListener('click', () => this.nextStep());
                this.submitBtn.addEventListener('click', (e) => this.handleSubmit(e));
                
                // åœ°å›³ã‚¿ã‚¤ãƒ—é¸æŠ
                this.mapTypeButtons.forEach(button => {
                    button.addEventListener('click', (e) => this.handleMapTypeSelection(e));
                });
                
                // ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ç›£è¦–
                this.form.addEventListener('input', () => this.validateCurrentStep());
                this.form.addEventListener('change', () => this.validateCurrentStep());
                
                console.log('ğŸ”— ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²å®Œäº†');
            }
            
            handleMapTypeSelection(e) {
                const value = e.target.dataset.value;
                
                // ãƒœã‚¿ãƒ³ã®é¸æŠçŠ¶æ…‹æ›´æ–°
                this.mapTypeButtons.forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                
                // éš ã—ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«å€¤è¨­å®š
                document.getElementById('mapType').value = value;
                
                // ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿æ›´æ–°
                this.formData.mapType = value;
                
                console.log('ğŸ“ åœ°å›³ã‚¿ã‚¤ãƒ—é¸æŠ:', value);
                this.validateCurrentStep();
            }
            
            validateCurrentStep() {
                let isValid = false;
                
                switch (this.currentStep) {
                    case 1: // åŒæ„ç¢ºèª
                        isValid = document.getElementById('privacyAgreement').checked;
                        this.updateAgreementUI(isValid);
                        break;
                        
                    case 2: // åŸºæœ¬æƒ…å ±
                        const name = document.getElementById('name').value.trim();
                        const year = document.getElementById('admissionYear').value;
                        const dept = document.getElementById('department').value;
                        isValid = name && year && dept;
                        this.updateRequiredFields(['name', 'admissionYear', 'department']);
                        break;
                        
                    case 3: // åœ°å›³ç¯„å›²
                        isValid = document.getElementById('mapType').value !== '';
                        break;
                        
                    case 4: // åœ°åŸŸé¸æŠ
                        const mapType = document.getElementById('mapType').value;
                        if (mapType === 'japan') {
                            isValid = document.getElementById('prefecture').value !== '';
                            this.updateRequiredFields(['prefecture']);
                        } else if (mapType === 'world') {
                            isValid = document.getElementById('worldArea').value !== '';
                            this.updateRequiredFields(['worldArea']);
                        } else {
                            isValid = true; // ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾ºã®å ´åˆã¯ã‚¹ã‚­ãƒƒãƒ—
                        }
                        break;
                        
                    case 5: // å ´æ‰€è©³ç´°
                        const placeName = document.getElementById('placeName').value.trim();
                        const memory = document.getElementById('memoryContent').value.trim();
                        isValid = placeName && memory;
                        this.updateRequiredFields(['placeName', 'memoryContent']);
                        break;
                        
                    case 6: // é€ä¿¡ç¢ºèª
                        isValid = true;
                        this.generateConfirmation();
                        break;
                }
                
                this.nextBtn.disabled = !isValid;
                return isValid;
            }
            
            updateAgreementUI(isValid) {
                const container = document.getElementById('agreementContainer');
                if (isValid) {
                    container.classList.remove('error');
                } else {
                    container.classList.add('error');
                }
            }
            
            updateRequiredFields(fieldIds) {
                fieldIds.forEach(fieldId => {
                    const field = document.getElementById(fieldId);
                    const value = field.value.trim();
                    
                    if (value) {
                        field.classList.remove('error');
                        field.classList.add('success');
                    } else {
                        field.classList.add('error');
                        field.classList.remove('success');
                    }
                });
            }
            
            nextStep() {
                if (!this.validateCurrentStep()) return;
                
                // ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
                this.saveCurrentStepData();
                
                // ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾ºé¸æŠæ™‚ã®ã‚¹ã‚­ãƒƒãƒ—ãƒ­ã‚¸ãƒƒã‚¯
                if (this.currentStep === 3 && this.formData.mapType === 'campus') {
                    this.currentStep = 5; // ã‚¹ãƒ†ãƒƒãƒ—4ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦5ã¸
                    console.log('ğŸ›ï¸ ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾ºé¸æŠ: ã‚¹ãƒ†ãƒƒãƒ—4ã‚’ã‚¹ã‚­ãƒƒãƒ—');
                } else {
                    this.currentStep++;
                }
                
                this.updateUI();
                this.validateCurrentStep();
            }
            
            previousStep() {
                // ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾ºã§ã‚¹ãƒ†ãƒƒãƒ—5ã‹ã‚‰æˆ»ã‚‹å ´åˆ
                if (this.currentStep === 5 && this.formData.mapType === 'campus') {
                    this.currentStep = 3; // ã‚¹ãƒ†ãƒƒãƒ—4ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦3ã¸
                    console.log('ğŸ›ï¸ ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾º: ã‚¹ãƒ†ãƒƒãƒ—4ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦æˆ»ã‚‹');
                } else {
                    this.currentStep--;
                }
                
                this.updateUI();
                this.validateCurrentStep();
            }
            
            saveCurrentStepData() {
                switch (this.currentStep) {
                    case 1:
                        this.formData.privacyAgreement = document.getElementById('privacyAgreement').checked;
                        break;
                    case 2:
                        this.formData.name = document.getElementById('name').value.trim();
                        this.formData.admissionYear = document.getElementById('admissionYear').value;
                        this.formData.department = document.getElementById('department').value;
                        break;
                    case 3:
                        this.formData.mapType = document.getElementById('mapType').value;
                        break;
                    case 4:
                        if (this.formData.mapType === 'japan') {
                            this.formData.area = document.getElementById('prefecture').value;
                        } else if (this.formData.mapType === 'world') {
                            this.formData.area = document.getElementById('worldArea').value;
                        }
                        break;
                    case 5:
                        this.formData.placeName = document.getElementById('placeName').value.trim();
                        this.formData.memoryContent = document.getElementById('memoryContent').value.trim();
                        this.formData.locationInfo = document.getElementById('locationInfo').value.trim();
                        this.formData.usefulPhrase = document.getElementById('usefulPhrase').value.trim();
                        break;
                }
                
                console.log('ğŸ’¾ ã‚¹ãƒ†ãƒƒãƒ—', this.currentStep, 'ãƒ‡ãƒ¼ã‚¿ä¿å­˜:', this.formData);
            }
            
            updateUI() {
                // ã‚¹ãƒ†ãƒƒãƒ—è¡¨ç¤ºæ›´æ–°
                this.steps.forEach((step, index) => {
                    if (index + 1 === this.currentStep) {
                        step.classList.add('active');
                    } else {
                        step.classList.remove('active');
                    }
                });
                
                // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹è¡¨ç¤ºæ›´æ–°
                this.progressSteps.forEach((step, index) => {
                    const stepNumber = index + 1;
                    if (stepNumber < this.currentStep) {
                        step.classList.add('completed');
                        step.classList.remove('active');
                    } else if (stepNumber === this.currentStep) {
                        step.classList.add('active');
                        step.classList.remove('completed');
                    } else {
                        step.classList.remove('active', 'completed');
                    }
                });
                
                // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³è¡¨ç¤ºåˆ¶å¾¡
                this.prevBtn.style.display = this.currentStep > 1 ? 'inline-flex' : 'none';
                this.nextBtn.style.display = this.currentStep < this.totalSteps ? 'inline-flex' : 'none';
                this.submitBtn.style.display = this.currentStep === this.totalSteps ? 'inline-flex' : 'none';
                
                // ã‚¹ãƒ†ãƒƒãƒ—4ã®åœ°åŸŸé¸æŠè¡¨ç¤ºåˆ¶å¾¡
                if (this.currentStep === 4) {
                    this.updateAreaSelection();
                }
                
                // ã‚¹ãƒ†ãƒƒãƒ—5ã®å½¹ç«‹ã¤ãƒ•ãƒ¬ãƒ¼ã‚ºè¡¨ç¤ºåˆ¶å¾¡
                if (this.currentStep === 5) {
                    this.updateUsefulPhraseVisibility();
                }
                
                console.log('ğŸ¨ UIæ›´æ–°å®Œäº† - ã‚¹ãƒ†ãƒƒãƒ—:', this.currentStep);
            }
            
            updateAreaSelection() {
                const mapType = this.formData.mapType || document.getElementById('mapType').value;
                const japanArea = document.getElementById('japanAreaSelection');
                const worldArea = document.getElementById('worldAreaSelection');
                
                if (mapType === 'japan') {
                    japanArea.style.display = 'block';
                    worldArea.style.display = 'none';
                } else if (mapType === 'world') {
                    japanArea.style.display = 'none';
                    worldArea.style.display = 'block';
                } else {
                    // ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾ºã®å ´åˆã€ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹
                    japanArea.style.display = 'none';
                    worldArea.style.display = 'none';
                }
            }
            
            updateUsefulPhraseVisibility() {
                const mapType = this.formData.mapType || document.getElementById('mapType').value;
                const usefulPhraseGroup = document.getElementById('usefulPhraseGroup');
                
                if (mapType === 'world') {
                    usefulPhraseGroup.style.display = 'block';
                } else {
                    usefulPhraseGroup.style.display = 'none';
                }
            }
            
            generateConfirmation() {
                const content = document.getElementById('confirmationContent');
                
                const mapTypeText = {
                    'campus': 'ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾º',
                    'japan': 'æ—¥æœ¬å…¨å›½',
                    'world': 'å…¨ä¸–ç•Œ'
                };
                
                const areaText = this.formData.mapType === 'japan' 
                    ? this.formData.area 
                    : this.formData.mapType === 'world' 
                        ? this.formData.area 
                        : 'ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹å‘¨è¾º';
                
                content.innerHTML = `
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 10px; margin-bottom: 1rem;">
                        <h3 style="margin-bottom: 1rem; color: #2c3e50;">å…¥åŠ›å†…å®¹ç¢ºèª</h3>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong>ãŠåå‰:</strong> ${this.formData.name}<br>
                            <strong>å…¥å­¦å¹´åº¦:</strong> ${this.formData.admissionYear}å¹´åº¦<br>
                            <strong>æ‰€å±å­¦éƒ¨:</strong> ${this.formData.department}
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong>åœ°å›³ç¯„å›²:</strong> ${mapTypeText[this.formData.mapType]}<br>
                            ${this.formData.mapType !== 'campus' ? `<strong>åœ°åŸŸ:</strong> ${areaText}<br>` : ''}
                        </div>
                        
                        <div style="margin-bottom: 1rem;">
                            <strong>å ´æ‰€å:</strong> ${this.formData.placeName}<br>
                            <strong>æ€ã„å‡º:</strong><br>
                            <div style="background: white; padding: 0.75rem; border-radius: 5px; margin-top: 0.5rem;">
                                ${this.formData.memoryContent.replace(/\n/g, '<br>')}
                            </div>
                        </div>
                        
                        ${this.formData.locationInfo ? `
                        <div style="margin-bottom: 1rem;">
                            <strong>ä½ç½®æƒ…å ±:</strong><br>
                            <div style="background: white; padding: 0.75rem; border-radius: 5px; margin-top: 0.5rem;">
                                ${this.formData.locationInfo.replace(/\n/g, '<br>')}
                            </div>
                        </div>
                        ` : ''}
                        
                        ${this.formData.usefulPhrase ? `
                        <div style="margin-bottom: 1rem;">
                            <strong>å½¹ç«‹ã¤ãƒ•ãƒ¬ãƒ¼ã‚º:</strong> ${this.formData.usefulPhrase}
                        </div>
                        ` : ''}
                    </div>
                `;
            }
            
            async handleSubmit(e) {
                e.preventDefault();
                
                console.log('ğŸ“¤ ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡é–‹å§‹');
                this.submitBtn.disabled = true;
                this.submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> é€ä¿¡ä¸­...';
                
                try {
                    // æœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
                    this.saveCurrentStepData();
                    
                    // test.htmlã¨åŒã˜ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                    if (!this.formData.name || !this.formData.name.trim()) {
                        throw new Error('åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                    }
                    if (!this.formData.memoryContent || !this.formData.memoryContent.trim()) {
                        throw new Error('æ€ã„å‡ºã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                    }
                    if (!this.formData.mapType) {
                        throw new Error('åœ°å›³ç¯„å›²ã‚’é¸æŠã—ã¦ãã ã•ã„');
                    }
                    if (!this.formData.privacyAgreement) {
                        throw new Error('ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼åŒæ„ãŒå¿…è¦ã§ã™');
                    }
                    
                    // Google Formsã«é€ä¿¡ (test.htmlã¨åŒã˜æ–¹å¼)
                    await window.GoogleFormsHandler.submitToGoogleForms(this.formData);
                    
                    console.log('âœ… é€ä¿¡æˆåŠŸ');
                    this.showSuccessMessage();
                    
                } catch (error) {
                    console.error('âŒ é€ä¿¡ã‚¨ãƒ©ãƒ¼:', error);
                    this.showErrorMessage(error.message);
                }
            }
            
            showSuccessMessage() {
                const messageDiv = document.getElementById('submitMessage');
                messageDiv.style.display = 'block';
                messageDiv.className = 'success-message';
                messageDiv.innerHTML = `
                    <i class="fas fa-check-circle"></i>
                    <strong>é€ä¿¡å®Œäº†ï¼</strong><br>
                    ã”å”åŠ›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸã€‚ã‚ãªãŸã®æ€ã„å‡ºã®å ´æ‰€ãŒFGSSmapã«è¿½åŠ ã•ã‚Œã¾ã™ã€‚
                `;
                
                this.submitBtn.style.display = 'none';
                this.prevBtn.style.display = 'none';
            }
            
            showErrorMessage(errorMsg = null) {
                const messageDiv = document.getElementById('submitMessage');
                messageDiv.style.display = 'block';
                messageDiv.className = 'error-message';
                messageDiv.innerHTML = `
                    <i class="fas fa-exclamation-triangle"></i>
                    <strong>é€ä¿¡ã‚¨ãƒ©ãƒ¼</strong><br>
                    ${errorMsg || 'ç”³ã—è¨³ã”ã–ã„ã¾ã›ã‚“ãŒã€é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ™‚é–“ã‚’ãŠã„ã¦å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚'}
                `;
                
                this.submitBtn.disabled = false;
                this.submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> å†é€ä¿¡';
            }
        }
        
        // ãƒ•ã‚©ãƒ¼ãƒ åˆæœŸåŒ– (test.htmlã¨åŒã˜æ–¹å¼)
        document.addEventListener('DOMContentLoaded', () => {
            window.formManager = new MultiStepFormManager();
            console.log('ğŸš€ 6ã‚¹ãƒ†ãƒƒãƒ—ãƒ•ã‚©ãƒ¼ãƒ æº–å‚™å®Œäº†');
            console.log('ğŸ’¡ å„ã‚¹ãƒ†ãƒƒãƒ—ã‚’é€²ã‚ã¦é€ä¿¡ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„');
        });
    </script>
</body>
</html>

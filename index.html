<!doctype html>
<html lang="ja" class="font-medium">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FGSSmap | æ€ã„å‡ºã®åœ°å›³ã‚’è¦‹ã‚‹</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{--base:16px;--primary:#5c6bc0;--accent:#ff7043;--bg:#f9f9f9;--card:#fff;--text:#333;--muted:#777}
    html{font-size:var(--base);scroll-behavior:smooth}
    html.font-small{font-size:14px}html.font-medium{font-size:16px}html.font-large{font-size:18px}
    body{font-family:'Montserrat',sans-serif;background:var(--bg);color:var(--text);line-height:1.6;margin:0}
    body.dark-mode{--bg:#2b2b2b;--card:#3c3c3c;--text:#f0f0f0;--muted:#aaa}
    *{box-sizing:border-box}a{color:inherit;text-decoration:none}
    .container{max-width:1000px;margin:0 auto;padding:0 20px}
    header{background:var(--primary);color:#fff;position:sticky;top:0;z-index:1000}
    .nav{display:flex;align-items:center;justify-content:center;height:60px;position:relative}
    .font-size-selector{position:absolute;left:20px;display:flex;gap:6px}
    .font-size-button{background:none;border:2px solid #fff;border-radius:4px;color:#fff;padding:4px 10px;font-size:.9rem;cursor:pointer}
    .font-size-button.active{background:#fff;color:var(--primary)}
    .logo-title{display:flex;align-items:center;gap:10px}
    .logo-title img{width:40px;height:40px;object-fit:contain}
    .site-title{font-size:1.4rem}
    #modeToggle{position:absolute;right:20px;background:none;border:none;color:#fff;font-size:1.2rem;cursor:pointer}
    .hero{background:linear-gradient(rgba(92,107,192,.8),rgba(92,107,192,.8)),url('hero-bg.jpg')center/cover no-repeat;color:#fff;text-align:center;padding:80px 20px}
    .hero h1{font-size:2.5rem;margin:0 0 16px}section{margin-top:60px;text-align:center}
    section h2{font-size:1.6rem;color:var(--primary);margin-bottom:24px}
    .map-container iframe{width:100%;max-width:1000px;height:500px;border:none;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.1)}
    .search-bar{margin-bottom:24px}
    .search-bar input{width:100%;max-width:400px;padding:10px 12px;border:1px solid #ccc;border-radius:4px;font-size:.95rem}
    .photo-cards,.memory-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:24px;margin-bottom:40px}
    .photo-card,.memory-card{background:var(--card);border-radius:8px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.1);transition:transform .18s,box-shadow .18s;text-align:left}
    .photo-card:hover,.memory-card:hover{transform:translateY(-6px);box-shadow:0 6px 18px rgba(0,0,0,.15)}
    .photo-card img{width:100%;height:140px;object-fit:cover}
    .memory-card-content,.memory-card .memory-card-content,.photo-card .memory-card-content{padding:16px}
    .photo-card h3,.memory-card h3{font-size:1.1rem;margin:0 0 8px}
    .photo-card p,.memory-card p{color:var(--muted);font-size:.95rem;margin:0 0 12px}
    .insta-link{display:inline-block;margin-top:16px;background:var(--accent);color:#fff;padding:10px 18px;border-radius:4px;font-weight:600}
    footer{background:#eee;color:#555;text-align:center;padding:20px;margin-top:60px;font-size:.85rem}
    #toTop{position:fixed;right:30px;bottom:30px;display:none;background:var(--primary);color:#fff;border:none;padding:10px 12px;border-radius:4px;cursor:pointer;font-size:1.2rem;z-index:100}
    @media(max-width:600px){.hero h1{font-size:2rem}.hero p{font-size:1rem}}
  </style>
</head>
<body>
  <header>
    <div class="container nav" role="navigation">
      <div class="font-size-selector" role="toolbar" aria-label="ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚º">
        <button class="font-size-button" data-size="small" aria-pressed="false">å°</button>
        <button class="font-size-button active" data-size="medium" aria-pressed="true">ä¸­</button>
        <button class="font-size-button" data-size="large" aria-pressed="false">å¤§</button>
      </div>

      <div class="logo-title">
        <img src="FGSSmap-icon.png" alt="FGSSmapãƒ­ã‚´">
        <span class="site-title">FGSSmap</span>
      </div>

      <button id="modeToggle" aria-pressed="false" aria-label="ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ">ğŸŒ™</button>
    </div>
  </header>

  <main>
    <div class="hero">
      <div class="container">
        <h1>ã¿ã‚“ãªã®æ€ã„å‡ºã‚’åœ°å›³ã«åˆ»ã‚‚ã†</h1>
        <p>å¤§å­¦ç”Ÿæ´»ã®ãƒ¯ã‚¯ãƒ¯ã‚¯ã‚’ã€FGSSmapã§ã„ã¤ã§ã‚‚æŒ¯ã‚Šè¿”ã‚ã†ã€‚</p>
      </div>
    </div>

    <section id="map">
      <div class="container">
        <h2>æ€ã„å‡ºãƒãƒƒãƒ—</h2>
        <div class="map-container" aria-live="polite">
          <iframe
            src="https://www.google.com/maps/d/u/0/embed?mid=1nTgYFWkXf1UQHwGZCwdXuRv-aopgUkY&hl=ja&ll=34.12382662506017,131.43323404999998&z=13"
            loading="lazy"
            title="æ€ã„å‡ºãƒãƒƒãƒ—"></iframe>
        </div>
      </div>
    </section>

    <section id="memories">
      <div class="container">
        <h2>ğŸ“ æ€ã„å‡ºã®å ´æ‰€ä¸€è¦§</h2>
        <div class="search-bar">
          <input id="searchInput" type="search" placeholder="å ´æ‰€åã§æ¤œç´¢â€¦" aria-controls="cardsContainer photoCardsContainer">
        </div>

        <div class="photo-cards" id="photoCardsContainer" aria-live="polite"></div>
        <div class="memory-cards" id="cardsContainer" aria-live="polite"></div>
      </div>
    </section>

    <section id="about">
      <div class="container organization">
        <h2>ğŸ“ é‹å–¶å›£ä½“ã«ã¤ã„ã¦</h2>
        <p>ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€å±±å£å¤§å­¦å›½éš›ç·åˆç§‘å­¦éƒ¨å…¬èªã‚µãƒ¼ã‚¯ãƒ« <strong>Palet's</strong> ã«ã‚ˆã£ã¦é‹å–¶ã•ã‚Œã¦ã„ã¾ã™ã€‚æ€ã„å‡ºã‚’å½¢ã«ã—ã€ã¿ã‚“ãªã§å…±æœ‰ã™ã‚‹ã“ã¨ã§ã€ã¤ãªãŒã‚Šã‚’æ·±ã‚ã¾ã™ã€‚</p>
        <a class="insta-link" href="https://www.instagram.com/palets_fgss/" target="_blank" rel="noopener">Instagramã§æ´»å‹•ã‚’è¦‹ã‚‹</a>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 Palet's. All rights reserved.</p>
    </div>
  </footer>

  <button id="toTop" aria-label="ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹">â†‘</button>

  <script>
    /* ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ */
    const $ = s => document.querySelector(s), $$ = s => Array.from(document.querySelectorAll(s));
    const escapeHtml = s => String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');

    /* ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºåˆ‡æ›¿ï¼ˆsmall/medium/largeï¼‰ + ä¿å­˜ */
    (function(){
      const btns = $$('.font-size-button');
      const apply = size => {
        document.documentElement.classList.remove('font-small','font-medium','font-large');
        document.documentElement.classList.add(size === 'small' ? 'font-small' : size === 'large' ? 'font-large' : 'font-medium');
        btns.forEach(b=>{ const on = b.dataset.size===size; b.classList.toggle('active',on); b.setAttribute('aria-pressed', on); });
        try{ localStorage.setItem('fgss_font_size', size); }catch(e){}
      };
      btns.forEach(b=>b.addEventListener('click',()=>apply(b.dataset.size)));
      const saved = (()=>{try{return localStorage.getItem('fgss_font_size')}catch(e){return null}})();
      apply(saved || 'medium');
    })();

    /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ + ä¿å­˜ */
    (function(){
      const btn = $('#modeToggle');
      const apply = dark => {
        document.body.classList.toggle('dark-mode', !!dark);
        btn.textContent = dark ? 'â˜€ï¸' : 'ğŸŒ™'; btn.setAttribute('aria-pressed', !!dark);
        try{ localStorage.setItem('fgss_dark_mode', !!dark ? '1':'0'); }catch(e){}
      };
      btn.addEventListener('click', ()=> apply(!document.body.classList.contains('dark-mode')));
      const saved = (()=>{try{return localStorage.getItem('fgss_dark_mode')}catch(e){return null}})();
      apply(saved===null ? (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) : saved==='1');
    })();

    /* Back to top */
    (function(){
      const toTop = $('#toTop');
      window.addEventListener('scroll', ()=> toTop.style.display = window.pageYOffset > 300 ? 'block' : 'none');
      toTop.addEventListener('click', ()=> window.scrollTo({top:0,behavior:'smooth'}));
    })();

    /* å†™çœŸã‚«ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ï¼ˆå¿…è¦ã«å¿œã˜ã¦ãƒ‘ã‚¹ã‚’ assets ã«ç½®ãï¼‰ */
    const photoCardsData = [
      {
        img: 'assets/yamaguchi-univ.jpg',
        title: 'å±±å£å¤§å­¦',
        desc: 'å±±å£å¤§å­¦ã¯å±±å£çœŒã«ã‚ã‚‹å›½ç«‹å¤§ã€‚å‰ç”°ãƒ»å¸¸ç›¤ãƒ»å°ä¸²ã®ï¼“ã‚­ãƒ£ãƒ³ãƒ‘ã‚¹ã§æ–‡ç³»ãƒ»ç†ç³»ãƒ»åŒ»å­¦ãƒ»å›½éš›ç·åˆç§‘å­¦ã¾ã§å¹…åºƒãå­¦ã¹ã€ç´„ï¼‘ä¸‡äººã®å­¦ç”ŸãŒåœ°åŸŸé€£æºã‚„SDGsã«ã‚‚ã‚¬ãƒ³ã‚¬ãƒ³æŒ‘æˆ¦ä¸­ï¼'
      }
    ];

    /* å†™çœŸã‚«ãƒ¼ãƒ‰æç”»ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰ */
    (function(){
      const container = $('#photoCardsContainer');
      photoCardsData.forEach(item=>{
        const d = document.createElement('article');
        d.className = 'photo-card';
        d.innerHTML = `<img src="${escapeHtml(item.img)}" alt="${escapeHtml(item.title)}"><div class="memory-card-content"><h3>${escapeHtml(item.title)}</h3><p>${escapeHtml(item.desc)}</p></div>`;
        container.appendChild(d);
      });
    })();

    /* KML -> ã‚«ãƒ¼ãƒ‰ç”Ÿæˆï¼ˆXSSå¯¾ç­–ã§ãƒ†ã‚­ã‚¹ãƒˆæŒ¿å…¥ã€CORSã«æ³¨æ„ï¼‰ */
    (function(){
      const kmlUrl = 'https://www.google.com/maps/d/kml?hl=ja&mid=1nTgYFWkXf1UQHwGZCwdXuRv-aopgUkY&nl=1&forcekml=1';
      fetch(kmlUrl).then(r=>r.text()).then(txt=>{
        const doc = new DOMParser().parseFromString(txt,'text/xml');
        const placemarks = doc.querySelectorAll('Placemark');
        const container = $('#cardsContainer');
        if(!placemarks.length) return;
        placemarks.forEach(pm=>{
          const name = escapeHtml(pm.querySelector('name')?.textContent || 'åç§°ä¸æ˜');
          const desc = escapeHtml(pm.querySelector('description')?.textContent || 'èª¬æ˜ãªã—');
          const card = document.createElement('article');
          card.className = 'memory-card';
          card.innerHTML = `<div class="memory-card-content"><h3>${name}</h3><p>${desc}</p><span>ğŸ“ My Mapsã‚ˆã‚Š</span></div>`;
          container.appendChild(card);
        });
      }).catch(err=>{
        console.warn('KML èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ï¼ˆCORS ã®å¯èƒ½æ€§ã‚ã‚Šï¼‰:', err);
      });
    })();

    /* æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã§çµã‚‹ï¼‰ */
    $('#searchInput').addEventListener('input', e=>{
      const kw = e.target.value.trim().toLowerCase();
      $$('.memory-card, .photo-card').forEach(card=>{
        const t = (card.querySelector('h3')?.textContent || '').toLowerCase();
        card.style.display = t.includes(kw) ? '' : 'none';
      });
    });
  </script>
</body>
</html>
